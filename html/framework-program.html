<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chương trình khung đào tạo và tiến độ học tập</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.14.1/themes/base/jquery-ui.min.css"
      rel="stylesheet"
    />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="../css/curriculum-framework.css" />
    <link rel="stylesheet" href="../css/index.css" />
    <link rel="stylesheet" href="../css/common.css" />
    <link
      href="https://kendo.cdn.telerik.com/2016.3.1118/styles/kendo.common.min.css"
      rel="stylesheet"
    />

    <link
      href="https://kendo.cdn.telerik.com/2016.3.1118/styles/kendo.default.min.css"
      rel="stylesheet"
    />
    <style>
      :root {
        --color-completed: #5b9bd5;
        --color-current: #ffc107;
        --color-remaining: #c5c5c5;
        --color-green-completed: #70ad47;
        --color-yellow-active: #ffc107;
        --border-thickness: 5px;
      }

      body {
        background-color: #f5f5f5;
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
      }

      .page-header {
        background: white;
        padding: 1.5rem;
        margin-bottom: 1rem;
      }

      .page-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: #333;
        margin-bottom: 0.5rem;
      }

      .page-subtitle {
        font-size: 0.875rem;
        color: #666;
        margin: 0;
      }

      /* Progress Section */
      .progress-section-title {
        background: white;
        border-radius: 12px;
        padding: 2rem;
        margin-bottom: 1rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .section-title {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
        color: #333;
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.875rem;
        color: #666;
      }

      .legend-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
      }

      .progress-bar-custom {
        height: 12px;
        border-radius: 6px;
        background-color: #f0f0f0;
        overflow: hidden;
        margin-bottom: 1.5rem;
      }

      .progress-segment {
        height: 100%;
        float: left;
      }

      .progress-label-container {
        display: flex;
        justify-content: space-between;
        font-size: 0.875rem;
        color: #666;
        margin-bottom: 0.5rem;
      }

      .progress-percentage {
        font-weight: 600;
        color: #333;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 1px;
        background: #e0e0e0;
        border-radius: 8px;
        overflow: hidden;
      }

      .stat-item {
        background: white;
        padding: 1.5rem 1rem;
        text-align: center;
      }

      .stat-value {
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        line-height: 1;
      }

      .stat-label {
        font-size: 0.813rem;
        color: #666;
      }

      /* Timeline Section */
      .timeline-section {
        background: white;
        border-radius: 12px;
        padding: 2rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        overflow: visible;
      }

      /* Animation keyframes */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes slideInLeft {
        from {
          opacity: 0;
          transform: translateX(-20px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes growWidth {
        from {
          width: 0;
        }
      }

      .timeline-container {
        position: relative;
        overflow: visible;
      }

      .timeline-wrapper {
        position: relative;
        overflow: visible;
      }

      .timeline-items {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        position: relative;
        padding-bottom: 2rem;
        overflow: visible;
      }

      .timeline-item {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
        opacity: 0;
        animation: fadeInUp 0.6s ease-out forwards;
        cursor: pointer;
      }

      /* Stagger animation delays */
      .timeline-item:nth-child(1) {
        animation-delay: 0.1s;
      }
      .timeline-item:nth-child(2) {
        animation-delay: 0.2s;
      }
      .timeline-item:nth-child(3) {
        animation-delay: 0.3s;
      }
      .timeline-item:nth-child(4) {
        animation-delay: 0.4s;
      }
      .timeline-item:nth-child(5) {
        animation-delay: 0.5s;
      }
      .timeline-item:nth-child(6) {
        animation-delay: 0.6s;
      }
      .timeline-item:nth-child(7) {
        animation-delay: 0.7s;
      }
      .timeline-item:nth-child(8) {
        animation-delay: 0.8s;
      }

      .timeline-circle-wrapper {
        position: relative;
        margin-bottom: 1rem;
        z-index: 2;
      }

      .timeline-circle {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        font-size: 0.938rem;
        background: white;
        position: relative;
        border: var(--border-thickness) solid transparent;
      }

      .timeline-circle.completed {
        border-color: var(--color-green-completed);
      }

      .timeline-circle.active {
        border-color: var(--color-yellow-active);
      }

      .timeline-circle.future {
        border-color: #d0d0d0;
      }

      /* Circle with partial progress - using border with gradient via ::before */
      .timeline-circle.partial-green,
      .timeline-circle.partial-mixed,
      .timeline-circle.partial-yellow {
        border: none;
      }

      .timeline-circle.partial-green::before {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: 50%;
        padding: var(--border-thickness);
        background: conic-gradient(
          var(--color-green-completed) 0deg,
          var(--color-green-completed) calc(var(--progress-green) * 3.6deg),
          #d0d0d0 calc(var(--progress-green) * 3.6deg),
          #d0d0d0 360deg
        );
        -webkit-mask:
          linear-gradient(#fff 0 0) content-box,
          linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask:
          linear-gradient(#fff 0 0) content-box,
          linear-gradient(#fff 0 0);
        mask-composite: exclude;
      }

      .timeline-circle.partial-mixed::before {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: 50%;
        padding: var(--border-thickness);
        background: conic-gradient(
          var(--color-green-completed) 0deg,
          var(--color-green-completed) calc(var(--progress-green) * 3.6deg),
          var(--color-yellow-active) calc(var(--progress-green) * 3.6deg),
          var(--color-yellow-active) calc(var(--progress-total) * 3.6deg),
          #d0d0d0 calc(var(--progress-total) * 3.6deg),
          #d0d0d0 360deg
        );
        -webkit-mask:
          linear-gradient(#fff 0 0) content-box,
          linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask:
          linear-gradient(#fff 0 0) content-box,
          linear-gradient(#fff 0 0);
        mask-composite: exclude;
      }

      .timeline-circle.partial-yellow::before {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: 50%;
        padding: var(--border-thickness);
        background: conic-gradient(
          var(--color-yellow-active) 0deg,
          var(--color-yellow-active) calc(var(--progress-yellow) * 3.6deg),
          #d0d0d0 calc(var(--progress-yellow) * 3.6deg),
          #d0d0d0 360deg
        );
        -webkit-mask:
          linear-gradient(#fff 0 0) content-box,
          linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask:
          linear-gradient(#fff 0 0) content-box,
          linear-gradient(#fff 0 0);
        mask-composite: exclude;
      }

      .timeline-circle > span {
        position: relative;
        z-index: 1;
        color: #333;
      }

      .timeline-circle.future > span {
        color: #999;
      }

      /* Tooltip styles */
      .semester-tooltip {
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%) translateY(-10px);
        background: white;
        color: #333;
        padding: 0.625rem 0.75rem;
        border-radius: 6px;
        font-size: 0.75rem;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        transition:
          opacity 0.3s ease,
          transform 0.3s ease;
        z-index: 10000 !important;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.12);
        border: 1px solid #e0e0e0;
        min-width: 180px;
      }

      .semester-tooltip::after {
        content: "";
        position: absolute;
        top: 100%;
        left: 50%;
        transform: translateX(-50%);
        border: 5px solid transparent;
        border-top-color: white;
      }

      .semester-tooltip::before {
        content: "";
        position: absolute;
        top: 100%;
        left: 50%;
        transform: translateX(-50%);
        border: 6px solid transparent;
        border-top-color: #e0e0e0;
        margin-top: 1px;
      }

      /* Tooltip positioned at bottom */
      .semester-tooltip.tooltip-bottom {
        bottom: auto;
        top: 100%;
        transform: translateX(-50%) translateY(10px);
      }

      .semester-tooltip.tooltip-bottom::after {
        top: auto;
        bottom: 100%;
        border-top-color: transparent;
        border-bottom-color: white;
      }

      .semester-tooltip.tooltip-bottom::before {
        top: auto;
        bottom: 100%;
        border-top-color: transparent;
        border-bottom-color: #e0e0e0;
        margin-top: 0;
        margin-bottom: 1px;
      }

      .timeline-item:hover .semester-tooltip,
      .timeline-semester-card:hover .semester-tooltip {
        opacity: 1;
      }

      .timeline-item:hover .semester-tooltip:not(.tooltip-bottom),
      .timeline-semester-card:hover .semester-tooltip:not(.tooltip-bottom) {
        transform: translateX(-50%) translateY(-5px);
      }

      .timeline-item:hover .semester-tooltip.tooltip-bottom,
      .timeline-semester-card:hover .semester-tooltip.tooltip-bottom {
        transform: translateX(-50%) translateY(5px);
      }

      .tooltip-row {
        display: flex;
        justify-content: space-between;
        gap: 0.75rem;
        margin-bottom: 0.25rem;
      }

      .tooltip-row:last-child {
        margin-bottom: 0;
      }

      .tooltip-label {
        color: #666;
      }

      .tooltip-value {
        font-weight: 600;
        color: #333;
      }

      .tooltip-divider {
        height: 1px;
        background: #e0e0e0;
        margin: 0.375rem 0;
      }

      .timeline-info {
        text-align: center;
        margin-bottom: 0.75rem;
      }

      .timeline-semester {
        font-weight: 600;
        font-size: 0.813rem;
        color: #333;
        margin-bottom: 0.25rem;
      }

      .timeline-credits {
        font-size: 0.75rem;
        color: #666;
      }

      .timeline-progress {
        width: 100%;
        max-width: 120px;
        position: relative;
      }

      .timeline-progress-bar {
        height: 24px;
        background-color: #e0e0e0;
        border-radius: 12px;
        overflow: hidden;
        position: relative;
        display: flex;
      }

      .timeline-progress-segment {
        height: 100%;
        transition: width 0.3s ease;
      }

      .timeline-progress-segment.completed {
        background-color: var(--color-green-completed);
      }

      .timeline-progress-segment.active {
        background-color: var(--color-yellow-active);
      }

      .timeline-progress-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 0.75rem;
        font-weight: 600;
        color: #333;
        white-space: nowrap;
        z-index: 1;
      }

      .timeline-progress-text.light {
        color: white;
      }

      /* Timeline bottom section - simplified */
      .timeline-bottom {
        position: relative;
      }

      .timeline-track-container {
        position: relative;
        height: 80px;
        margin-bottom: 2rem;
      }

      .timeline-track {
        position: absolute;
        top: 8px;
        left: 0;
        right: 0;
        height: 2px;
        background-color: #e0e0e0;
      }

      .timeline-track-progress {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        background-color: var(--color-green-completed);
        transition: width 0.3s ease;
        animation: growWidth 1.5s ease-out;
      }

      /* Year markers positioned absolutely to align with semester circles */
      .timeline-year-markers {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 100%;
      }

      .timeline-year-marker {
        position: absolute;
        display: flex;
        flex-direction: column;
        align-items: center;
        transform: translateX(-50%);
        opacity: 0;
        animation: fadeIn 0.8s ease-out forwards;
      }

      .timeline-year-marker:nth-child(1) {
        animation-delay: 0.2s;
      }
      .timeline-year-marker:nth-child(2) {
        animation-delay: 0.5s;
      }
      .timeline-year-marker:nth-child(3) {
        animation-delay: 0.8s;
      }
      .timeline-year-marker:nth-child(4) {
        animation-delay: 1.1s;
      }
      .timeline-year-marker:nth-child(5) {
        animation-delay: 1.4s;
      }
      .timeline-year-marker:nth-child(6) {
        animation-delay: 1.7s;
      }

      .timeline-year-dot {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        margin-bottom: 0.75rem;
        position: relative;
        z-index: 2;
      }

      .timeline-year-dot.current {
        background-color: var(--color-green-completed);
      }

      .timeline-year-dot.future {
        background-color: #d0d0d0;
      }

      .timeline-year-label {
        font-size: 0.875rem;
        font-weight: 600;
        color: #5b9bd5;
        margin-bottom: 0.25rem;
        text-align: center;
      }

      .timeline-year-semesters {
        font-size: 0.75rem;
        color: #666;
        text-align: center;
        white-space: nowrap;
      }

      .timeline-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-top: 1.5rem;
        border-top: 1px solid #e0e0e0;
        margin-top: 1rem;
      }

      .timeline-date {
        font-size: 0.875rem;
        color: #666;
      }

      .timeline-legends {
        display: flex;
        gap: 2rem;
      }

      /* Content Section */
      .content-section {
        background: white;
        border-radius: 12px;
        padding: 2rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .search-box {
        flex: 1;
        min-width: 300px;
        max-width: 400px;
      }

      .search-input {
        width: 100%;
        padding: 0.75rem 1rem 0.75rem 2.5rem;
        border: 1px solid #ddd;
        border-radius: 8px;
        font-size: 0.875rem;
      }

      .search-icon {
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: #999;
      }

      .filter-buttons {
        display: flex;
        gap: 0.75rem;
        flex-wrap: wrap;
      }

      .filter-btn {
        padding: 0.75rem 1.5rem;
        border: 1px solid #ddd;
        border-radius: 8px;
        background: white;
        font-size: 0.875rem;
        cursor: pointer;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .filter-btn:hover {
        border-color: var(--color-completed);
        background-color: #f8f9fa;
      }

      .filter-btn.active {
        background-color: var(--color-completed);
        color: white;
        border-color: var(--color-completed);
      }

      /* Hamburger Menu */
      .hamburger-menu {
        display: none;
        background: none;
        border: none;
        font-size: 24px;
        color: #333;
        cursor: pointer;
        padding: 8px;
        transition: all 0.3s ease;
      }

      .hamburger-menu:hover {
        color: #0066cc;
      }

      /* Sidebar Overlay */
      .sidebar-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 998;
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .sidebar-overlay.active {
        display: block;
        opacity: 1;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .hamburger-menu {
          display: block;
        }

        .sidebar {
          position: fixed;
          left: -250px;
          top: 0;
          height: 100vh;
          z-index: 999;
          transition: left 0.3s ease;
        }

        .sidebar.active {
          left: 0;
        }
        .page-header {
          padding: 1rem;
        }

        .progress-section,
        .timeline-section,
        .content-section {
          padding: 1.5rem;
        }

        .stats-grid {
          grid-template-columns: repeat(2, 1fr);
        }

        /* Mobile Timeline - Vertical Layout */
        .timeline-wrapper {
          display: none; /* Hide desktop timeline */
        }

        .timeline-container {
          position: relative;
        }

        /* Mobile timeline will be rendered by JS */
        .timeline-mobile {
          display: flex;
          flex-direction: column;
          gap: 2rem;
          position: relative;
          padding-left: 3rem;
          overflow: visible;
        }

        .timeline-mobile::before {
          content: "";
          position: absolute;
          left: 10px;
          top: 0;
          bottom: 0;
          width: 3px;
          background: linear-gradient(
            to bottom,
            var(--color-green-completed) 0%,
            var(--color-green-completed) var(--progress-percent, 50%),
            #e0e0e0 var(--progress-percent, 50%),
            #e0e0e0 100%
          );
          animation: fadeIn 0.8s ease-out;
        }

        .timeline-year-group {
          position: relative;
          opacity: 0;
          animation: slideInLeft 0.6s ease-out forwards;
          overflow: visible;
        }

        .timeline-year-group:nth-child(1) {
          animation-delay: 0.1s;
        }
        .timeline-year-group:nth-child(2) {
          animation-delay: 0.3s;
        }
        .timeline-year-group:nth-child(3) {
          animation-delay: 0.5s;
        }
        .timeline-year-group:nth-child(4) {
          animation-delay: 0.7s;
        }

        .timeline-year-marker-mobile {
          position: absolute;
          left: -3rem;
          top: 0;
          display: flex;
          flex-direction: column;
          align-items: center;
        }

        .timeline-year-marker-mobile .timeline-year-dot {
          width: 24px;
          height: 24px;
          border-radius: 50%;
          margin-bottom: 0.5rem;
          z-index: 2;
        }

        .timeline-year-marker-mobile .timeline-year-label {
          font-size: 0.75rem;
          font-weight: 600;
          color: #5b9bd5;
          white-space: nowrap;
          writing-mode: vertical-rl;
          text-orientation: mixed;
        }

        .timeline-semesters-horizontal {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 1rem;
          margin-bottom: 1rem;
          overflow: visible;
        }

        .timeline-semester-card {
          background: white;
          border: 2px solid #e0e0e0;
          border-radius: 12px;
          padding: 1rem;
          z-index: 100 !important;
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.75rem;
          transition:
            transform 0.3s ease,
            box-shadow 0.3s ease;
          position: relative;
          cursor: pointer;
        }

        .timeline-semester-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .timeline-semester-card.completed {
          border-color: var(--color-green-completed);
          background-color: #f0f9ff;
        }

        .timeline-semester-card.active {
          border-color: var(--color-yellow-active);
          background-color: #fffbf0;
        }

        .timeline-semester-card.mixed {
          border-color: var(--color-yellow-active);
          background-color: #fffbf0;
        }

        .timeline-semester-card .timeline-circle {
          width: 50px;
          height: 50px;
          font-size: 0.75rem;
        }

        .timeline-semester-card .timeline-info {
          margin-bottom: 0;
        }

        .timeline-semester-card .timeline-semester {
          font-size: 0.813rem;
        }

        .timeline-semester-card .timeline-credits {
          font-size: 0.7rem;
        }

        .timeline-semester-card .timeline-progress {
          max-width: 100px;
        }

        .timeline-semester-card .timeline-progress-bar {
          height: 20px;
        }

        .timeline-footer {
          flex-direction: column;
          gap: 1rem;
          text-align: center;
        }

        .timeline-legends {
          flex-direction: row;
          gap: 1rem;
          flex-wrap: wrap;
          justify-content: center;
        }

        .controls-section {
          width: 100%;
          flex-direction: column;
        }

        .search-box {
          min-width: 100%;
        }

        .filter-buttons {
          justify-content: stretch;
          width: 100%;
        }

        .filter-btn {
          flex: 1;
        }

        .content-wrapper-tab-group {
          flex-direction: column;
          gap: 1rem;
        }

        .tab-buttons {
          justify-content: stretch;
          width: 100%;
        }

        .tab-btn {
          flex: 1;
          justify-content: center;
        }
      }

      @media (max-width: 576px) {
        .stats-grid {
          grid-template-columns: 1fr;
        }

        .stat-value {
          font-size: 1.75rem;
        }

        .timeline-mobile {
          padding-left: 2.5rem;
        }

        .timeline-year-marker-mobile {
          left: -2.5rem;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header class="header-container">
      <div class="left-header-container">
        <button class="hamburger-menu" id="hamburgerMenu">
          <i class="fas fa-bars"></i>
        </button>
        <div class="logo-div">
          <!-- Todo Logo -->
        </div>
        <div class="search-bar">
          <input type="text" placeholder="Tìm kiếm..." />
          <i class="fa-solid fa-magnifying-glass"></i>
        </div>
      </div>
      <div class="right-header-container">
        <div>
          <i class="fa-regular fa-house"></i>
          <span>Trang chủ</span>
        </div>
        <div>
          <i class="fa-regular fa-bell"></i>
          <span>Tin tức</span>
        </div>
        <div class="login-infor">
          <div class="avatar">
            <img
              src="../img/user.png"
              alt="User Image"
              width="15"
              height="15"
            />
          </div>
          <span style="font-size: larger">Asc Test</span>
        </div>
      </div>
    </header>
    <!-- Content -->
    <main class="main-content">
      <div class="sidebar-overlay" id="sidebarOverlay"></div>
      <!-- Sidebar -->
      <aside class="sidebar" id="sidebar">
        <nav class="nav-menu">
          <!-- Trang chủ -->
          <a href="#" class="nav-item nav-parent active">
            <i class="fas fa-home"></i>
            <span style="width: 90%">Trang chủ</span>
          </a>

          <!-- Thông tin chung -->
          <div class="nav-group">
            <div class="nav-parent">
              <i class="fas fa-info-circle"></i>
              <span>Thông tin chung</span>
              <i class="fas fa-chevron-down dropdown-icon"></i>
            </div>
            <div class="nav-submenu">
              <a href="#" class="nav-subitem">
                <span>Đăng ký nội trú</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Hồ sơ điện tử</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Đề xuất cập nhật thông tin</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Đề xuất biểu mẫu</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Đăng ký chuyên ngành</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Lịch sử khai báo BHYT</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Khai báo thông tin BHYT</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Đề xuất xét tốt nghiệp</span>
              </a>
            </div>
          </div>

          <!-- Học tập -->
          <div class="nav-group">
            <div class="nav-parent">
              <i class="fas fa-graduation-cap"></i>
              <span>Học tập</span>
              <i class="fas fa-chevron-down dropdown-icon"></i>
            </div>
            <div class="nav-submenu">
              <a href="#" class="nav-subitem">
                <span>Kết quả học tập</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Thông tin điểm danh</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Kết quả rèn luyện</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Lịch theo tuần</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Lịch theo tiến độ</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Đăng ký phúc khảo</span>
              </a>
            </div>
          </div>

          <!-- Học phí -->
          <div class="nav-group">
            <div class="nav-parent">
              <i class="fas fa-money-bill-wave"></i>
              <span>Học phí</span>
              <i class="fas fa-chevron-down dropdown-icon"></i>
            </div>
            <div class="nav-submenu">
              <a href="#" class="nav-subitem">
                <span>Thanh toán trực tuyến</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Thanh toán nội trú</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Phiếu thu trực tuyến</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Tra cứu công nợ</span>
              </a>
            </div>
          </div>

          <!-- Đăng ký học phần -->
          <div class="nav-group">
            <div class="nav-parent">
              <i class="fas fa-book-open"></i>
              <span>Đăng ký học phần</span>
              <i class="fas fa-chevron-down dropdown-icon"></i>
            </div>
            <div class="nav-submenu">
              <a href="#" class="nav-subitem">
                <span>Đăng ký thi lại - thi cải thiện</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Đăng ký môn học điều kiện</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Chương trình khung</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Đăng ký học phần</span>
              </a>
            </div>
          </div>

          <!-- Khác -->
          <div class="nav-group">
            <div class="nav-parent">
              <i class="fas fa-ellipsis-h"></i>
              <span>Khác</span>
              <i class="fas fa-chevron-down dropdown-icon"></i>
            </div>
            <div class="nav-submenu">
              <a href="#" class="nav-subitem">
                <span>Hộp thư sinh viên</span>
              </a>
              <a href="#" class="nav-subitem">
                <span>Liên hệ góp ý</span>
              </a>
            </div>
          </div>
        </nav>
      </aside>
      <!-- Details -->
      <div class="container-lg">
        <!-- Progress Section -->
        <div class="content-wrapper">
          <div class="progress-section">
            <div class="learning-progress-title">
              <div class="section-title">Tiến độ học tập</div>

              <div class="progress-label">
                <span
                  ><i class="fa-solid fa-circle badge-completed"></i> Đã hoàn
                  thành</span
                >
                <span
                  ><i class="fa-solid fa-circle badge-progress"></i> Tin chỉ
                  đang học</span
                >
                <span
                  ><i class="fa-solid fa-circle badge-notstart"></i> Tin chỉ còn
                  lại</span
                >
              </div>
            </div>

            <div class="progress-bar-div">
              <div class="progress-bar-title">
                <div>Đã hoàn thành</div>
                <div>
                  <span class="progress-percentage" id="overallPercentage"
                    >75%</span
                  >
                </div>
              </div>
              <div id="chart" class="progress-chart" style="width: 100%"></div>
            </div>

            <div class="stats-container">
              <div class="stat-box">
                <div class="stat-number green" id="totalCredits">162</div>
                <div class="stat-label">Tổng tin chỉ</div>
              </div>
              <div class="stat-box">
                <div class="stat-number blue" id="completedCredits">122</div>
                <div class="stat-label">Đã hoàn thành</div>
              </div>
              <div class="stat-box">
                <div class="stat-number yellow" id="currentCredits">24</div>
                <div class="stat-label">Tin chỉ đang học</div>
              </div>
              <div class="stat-box">
                <div class="stat-number gray" id="remainingCredits">16</div>
                <div class="stat-label">Tin chỉ còn lại</div>
              </div>
              <div class="stat-box-end">
                <div class="stat-number yellow" id="progressDiff">+ 2%</div>
                <div class="stat-label">Tiến độ so với kế hoạch</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Controls Section -->
        <div class="content-wrapper-tab-group">
          <div class="tab-buttons">
            <button class="tab-btn active">Học kỳ</button>
            <button class="tab-btn">Khối kiến thức</button>
          </div>

          <div class="controls-section">
            <div class="search-box">
              <input
                type="text"
                placeholder="Tìm kiếm môn học theo tên hoặc mã..."
              />
            </div>
            <div class="action-buttons">
              <button class="btn-custom primary">
                <i class="fas fa-bars"></i>
                Tất cả
              </button>
              <button class="btn-custom">
                <i class="fab fa-leanpub"></i>
                Chưa học
              </button>
              <button class="btn-custom">
                <i class="far fa-calendar-alt"></i>
                Bắt buộc
              </button>
            </div>
          </div>
        </div>

        <!-- Timeline Section -->
        <div class="content-wrapper">
          <div class="timeline-section">
            <h2 class="section-title">Lộ trình học tập</h2>

            <div class="timeline-container">
              <div class="timeline-wrapper">
                <!-- Semester circles -->
                <div class="timeline-items" id="timelineItems"></div>

                <!-- Timeline track with year markers -->
                <div class="timeline-bottom">
                  <div class="timeline-track-container">
                    <div class="timeline-track">
                      <div
                        class="timeline-track-progress"
                        id="timelineTrackProgress"
                      ></div>
                    </div>
                    <div
                      class="timeline-year-markers"
                      id="timelineYearMarkers"
                    ></div>
                  </div>
                </div>
              </div>
            </div>

            <div class="timeline-footer">
              <div class="timeline-date">
                <i class="fas fa-calendar-alt me-2"></i
                ><span id="startDate">9/2022</span>
              </div>
              <!-- <div class="timeline-legends">
                <div class="legend-item">
                  <span
                    class="legend-dot"
                    style="background-color: var(--color-green-completed)"
                  ></span>
                  <span>Hoàn thành</span>
                </div>
                <div class="legend-item">
                  <span
                    class="legend-dot"
                    style="background-color: var(--color-yellow-active)"
                  ></span>
                  <span>Đang học</span>
                </div>
                <div class="legend-item">
                  <span
                    class="legend-dot"
                    style="background-color: #e0e0e0"
                  ></span>
                  <span>Chưa học</span>
                </div>
              </div> -->
              <div class="legend">
                <div class="legend-item">
                  <div
                    class="legend-color"
                    style="background-color: var(--success-green)"
                  ></div>
                  <span>Hoàn thành</span>
                </div>
                <div class="legend-item">
                  <div
                    class="legend-color"
                    style="background-color: var(--primary-yellow)"
                  ></div>
                  <span>Đang học</span>
                </div>
                <div class="legend-item">
                  <div
                    class="legend-color"
                    style="background-color: #ccc"
                  ></div>
                  <span>Chưa học</span>
                </div>
              </div>
              <div class="timeline-date">
                <i class="fas fa-calendar-check me-2"></i
                ><span id="endDate">6/2026</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Knowledge Blocks Overview -->
        <div class="content-wrapper">
          <div class="knowledge-block-overview">
            <div class="section-title">Tổng quan khối kiến thức</div>

            <div class="knowledge-blocks">
              <div class="knowledge-block">
                <div class="circle-progress">
                  <svg viewBox="0 0 120 120">
                    <circle
                      cx="60"
                      cy="60"
                      r="50"
                      fill="none"
                      stroke="#e9ecef"
                      stroke-width="8"
                    />
                    <circle
                      cx="60"
                      cy="60"
                      r="50"
                      fill="none"
                      stroke="#ffb800"
                      stroke-width="8"
                      stroke-dasharray="157 314"
                      stroke-dashoffset="0"
                    />
                  </svg>
                  <div class="circle-text yellow">GDDC</div>
                </div>
                <div class="block-title">Giáo dục đại cương</div>
                <div class="block-code">32/31 tin chỉ</div>
                <div class="block-progress">
                  <div class="block-progress-bar yellow"></div>
                </div>
              </div>

              <div class="knowledge-block">
                <div class="circle-progress">
                  <svg viewBox="0 0 120 120">
                    <circle
                      cx="60"
                      cy="60"
                      r="50"
                      fill="none"
                      stroke="#e9ecef"
                      stroke-width="8"
                    />
                    <circle
                      cx="60"
                      cy="60"
                      r="50"
                      fill="none"
                      stroke="#ffb800"
                      stroke-width="8"
                      stroke-dasharray="157 314"
                      stroke-dashoffset="0"
                    />
                  </svg>
                  <div class="circle-text yellow">GDCN</div>
                </div>
                <div class="block-title">Giáo dục chuyên nghiệp</div>
                <div class="block-code">65/96 tin chỉ</div>
                <div class="block-progress">
                  <div class="block-progress-bar yellow"></div>
                </div>
              </div>

              <div class="knowledge-block">
                <div class="circle-progress">
                  <svg viewBox="0 0 120 120">
                    <circle
                      cx="60"
                      cy="60"
                      r="50"
                      fill="none"
                      stroke="#e9ecef"
                      stroke-width="8"
                    />
                    <circle
                      cx="60"
                      cy="60"
                      r="50"
                      fill="none"
                      stroke="#28a745"
                      stroke-width="8"
                      stroke-dasharray="251 314"
                      stroke-dashoffset="0"
                    />
                  </svg>
                  <div class="circle-text green">N/A</div>
                </div>
                <div class="block-title">Chưa xác định</div>
                <div class="block-code">22/22 tin chỉ</div>
                <div class="block-progress">
                  <div class="block-progress-bar"></div>
                </div>
              </div>
            </div>
          </div>

          <div class="legend">
            <div class="legend-item">
              <div
                class="legend-color"
                style="background-color: var(--success-green)"
              ></div>
              <span>Hoàn thành</span>
            </div>
            <div class="legend-item">
              <div
                class="legend-color"
                style="background-color: var(--primary-yellow)"
              ></div>
              <span>Đang học</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background-color: #ccc"></div>
              <span>Chưa học</span>
            </div>
          </div>
        </div>

        <!-- Expandable Sections -->
        <div class="content-wrapper" id="expandableSections">
          <!-- JavaScript Render -->
        </div>

        <div class="footer-section">© 2025</div>
      </div>
    </main>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.14.1/jquery-ui.min.js"></script>

    <script src="../js/curriculum-framework.js"></script>

    <script src="../js/study-progress.js"></script>

    <script src="https://kendo.cdn.telerik.com/2016.3.1118/js/kendo.all.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.8/js/bootstrap.bundle.min.js"></script>
    <script src="../js/common.js"></script>

    <script>
      // Current academic year

      // Initialize
      document.addEventListener("DOMContentLoaded", function () {
        handleResize();
        window.addEventListener("resize", handleResize);
      });

      $("#chart").kendoChart({
        chartArea: {
          height: 30,
          background: "#f4fbff",
        },
        legend: { visible: false },
        seriesDefaults: {
          type: "bar",
          stack: true,
        },
        series: [
          { data: [60], color: "#56a2e8" }, // xanh
          { data: [15], color: "#ffb800" }, // vàng
          { data: [25], color: "#e0e0e0" }, // xám
        ],
        valueAxis: {
          min: 0,
          max: 100,
          visible: false,
          majorGridLines: { visible: false },
          minorGridLines: { visible: false },
        },
        categoryAxis: {
          categories: [""],
          visible: false,
          majorGridLines: { visible: false },
          minorGridLines: { visible: false },
        },
        tooltip: {
          visible: true,
          template: "#= value #%",
        },
        dataBound: function () {
          var svg = $("#chart svg");

          svg.find("rect[fill]").each(function () {
            var rect = $(this);
            var fill = rect.attr("fill");

            if (fill && !fill.includes("url")) {
              rect.attr("rx", 8);
              rect.attr("ry", 8);
            }
          });
        },
      });

      // function adjustTooltipPosition(element) {
      //   const tooltip = element.querySelector(".semester-tooltip");
      //   if (!tooltip) return;

      //   const rect = element.getBoundingClientRect();
      //   const tooltipRect = tooltip.getBoundingClientRect();
      //   const viewportHeight = window.innerHeight;

      //   // Check if there's enough space above
      //   const spaceAbove = rect.top;
      //   const spaceBelow = viewportHeight - rect.bottom;
      //   const tooltipHeight = tooltipRect.height || 200;

      //   if (spaceAbove < tooltipHeight + 20 && spaceBelow > spaceAbove) {
      //     tooltip.classList.add("tooltip-bottom");
      //   } else {
      //     tooltip.classList.remove("tooltip-bottom");
      //   }
      // }

      // Add hover listeners to adjust tooltip position
      // function addTooltipListeners() {
      //   document
      //     .querySelectorAll(".timeline-item, .timeline-semester-card")
      //     .forEach((item) => {
      //       item.addEventListener("mouseenter", () =>
      //         adjustTooltipPosition(item),
      //       );
      //     });
      // }

      // Handle responsive timeline rendering
      function handleResize() {
        const isMobile = window.innerWidth <= 768;
        const container = document.querySelector(".timeline-container");
        if (!container) return;

        const wrapper = container.querySelector(".timeline-wrapper");
        let mobileTimeline = container.querySelector(".timeline-mobile");

        if (isMobile) {
          if (wrapper) wrapper.style.display = "none";
          if (!mobileTimeline) {
            mobileTimeline = document.createElement("div");
            mobileTimeline.className = "timeline-mobile";
            container.appendChild(mobileTimeline);
          }
          renderMobileTimeline();
        } else {
          if (wrapper) wrapper.style.display = "block";
          if (mobileTimeline) {
            mobileTimeline.remove();
          }
        }

        // setTimeout(addTooltipListeners, 100);
      }

      // Render mobile timeline
      function renderMobileTimeline() {
        const container = document.querySelector(".timeline-mobile");
        if (!container) return;

        // Clear existing content first to prevent double rendering
        container.innerHTML = "";

        const yearGroups = {};
        timelineData.forEach((sem) => {
          if (!yearGroups[sem.year]) {
            yearGroups[sem.year] = [];
          }
          yearGroups[sem.year].push(sem);
        });

        const uniqueYears = Object.keys(yearGroups);

        const currentYearIndex = uniqueYears.indexOf(currentAcademicYear);
        const totalYears = uniqueYears.length;

        let progressPercent = 0;
        if (currentYearIndex >= 0) {
          progressPercent = (currentYearIndex / totalYears) * 100;
        }

        // Don't clear innerHTML here, already done at the start of function

        uniqueYears.forEach((year, yearIndex) => {
          const yearSems = yearGroups[year];
          const dotClass = year <= currentAcademicYear ? "current" : "future";
          const totalSemesters = timelineData.length;

          const firstSemIndex = timelineData.findIndex((s) => s.year === year);

          // Position in the middle between sem1 and sem2 of this year
          // Middle = (index0 + index1) / 2 = index0 + 0.5
          // Convert to percentage: (middle / total) * 100
          const middlePosition = firstSemIndex + 1;
          const progressPercent = (yearIndex / totalYears) * 100 + 3;

          if (yearIndex === currentYearIndex && currentYearIndex >= 0) {
            container.style.setProperty(
              "--progress-percent",
              progressPercent + "%",
            );
          } else if (currentYearIndex < 0) {
            container.style.setProperty("--progress-percent", 100 + "%");
          }
          const yearGroup = document.createElement("div");
          yearGroup.className = "timeline-year-group";

          // Year marker
          const yearMarker = document.createElement("div");
          yearMarker.className = "timeline-year-marker-mobile";
          yearMarker.innerHTML = `
            <div class="timeline-year-dot ${dotClass}"></div>
          `;
          // <div class="timeline-year-label">${year}</div>;
          yearGroup.appendChild(yearMarker);

          // Semesters in horizontal layout
          const semestersContainer = document.createElement("div");
          semestersContainer.className = "timeline-semesters-horizontal";

          yearSems.forEach((sem) => {
            const card = document.createElement("div");
            card.className = "timeline-semester-card";

            const completedPercent =
              (sem.completedCredits / sem.totalCredits) * 100;
            const currentPercent =
              (sem.currentCredits / sem.totalCredits) * 100;
            const totalPercent = completedPercent + currentPercent;

            // Determine card status
            if (sem.status === "completed" && sem.progress === 100) {
              card.classList.add("completed");
            } else if (sem.status === "active") {
              card.classList.add("active");
            } else if (sem.status === "mixed") {
              card.classList.add("mixed");
            }

            // Circle with progress
            let circleClass = "";
            let circleStyle = "";

            if (sem.status === "completed" && sem.progress === 100) {
              circleClass = "completed";
            } else if (sem.status === "active" && sem.completedCredits === 0) {
              circleClass = "active";
            } else if (
              (sem.status === "mixed" || totalPercent > 0) &&
              sem.completedCredits > 0 &&
              sem.currentCredits > 0
            ) {
              circleClass = "partial-mixed";
              circleStyle = `style="--progress-green: ${completedPercent}; --progress-total: ${totalPercent}"`;
            } else if (
              sem.completedCredits > 0 &&
              sem.completedCredits < sem.totalCredits
            ) {
              circleClass = "partial-green";
              circleStyle = `style="--progress-green: ${completedPercent}"`;
            } else if (sem.currentCredits > 0 && sem.completedCredits === 0) {
              circleClass = "partial-yellow";
              circleStyle = `style="--progress-yellow: ${currentPercent}"`;
            } else {
              circleClass = "future";
            }

            // Progress bar
            let progressBarHTML = "";
            let progressTextClass = "";

            if (completedPercent > 0 && currentPercent > 0) {
              progressBarHTML = `
                <div class="timeline-progress-segment completed" style="width: ${completedPercent}%;"></div>
                <div class="timeline-progress-segment active" style="width: ${currentPercent}%;"></div>
              `;
              progressTextClass = totalPercent > 50 ? "light" : "";
            } else if (completedPercent > 0) {
              progressBarHTML = `<div class="timeline-progress-segment completed" style="width: ${completedPercent}%;"></div>`;
              progressTextClass = completedPercent > 50 ? "light" : "";
            } else if (currentPercent > 0) {
              progressBarHTML = `<div class="timeline-progress-segment active" style="width: ${currentPercent}%;"></div>`;
              progressTextClass = currentPercent > 50 ? "light" : "";
            }

            const displayPercent = Math.round(totalPercent);
            const displayCredits = `${sem.completedCredits + sem.currentCredits}/${sem.totalCredits}`;
            const remainingCredits =
              sem.totalCredits - sem.completedCredits - sem.currentCredits;

            card.innerHTML = `
              <div class="timeline-circle ${circleClass}" ${circleStyle}>
                <span>HK${sem.semester}</span>
              </div>
              <div class="timeline-info">
                <div class="timeline-semester">Học kỳ ${sem.semester}</div>
                <div class="timeline-credits">${displayCredits} tín chỉ</div>
              </div>
              <div class="timeline-progress">
                <div class="timeline-progress-bar">
                  ${progressBarHTML}
                  <div class="timeline-progress-text ${progressTextClass}">${displayPercent}%</div>
                </div>
              </div>
              <div class="semester-tooltip">
                <div class="tooltip-row">
                  <span class="tooltip-label">Học kỳ:</span>
                  <span class="tooltip-value">HK${sem.semester}</span>
                </div>
                <div class="tooltip-row">
                  <span class="tooltip-label">Đã học:</span>
                  <span class="tooltip-value">${sem.completedCredits}/${sem.totalCredits} TC</span>
                </div>
                <div class="tooltip-row">
                  <span class="tooltip-label">Đang học:</span>
                  <span class="tooltip-value">${sem.currentCredits} TC</span>
                </div>
              </div>
            `;

            semestersContainer.appendChild(card);
          });

          yearGroup.appendChild(semestersContainer);
          container.appendChild(yearGroup);
        });
      }

      // renderProgress and renderTimeline are now in study-progress.js
      // Removed duplicate functions to fix double rendering issue

      function renderTimeline_DISABLED() {
        const container = document.getElementById("timelineItems");
        const markersContainer = document.getElementById("timelineYearMarkers");
        const trackProgress = document.getElementById("timelineTrackProgress");

        const yearGroups = {};
        timelineData.forEach((sem) => {
          if (!yearGroups[sem.year]) {
            yearGroups[sem.year] = [];
          }
          yearGroups[sem.year].push(sem);
        });

        const uniqueYears = Object.keys(yearGroups);
        const totalSemesters = timelineData.length;

        const currentYearIndex = uniqueYears.indexOf(currentAcademicYear);
        if (currentYearIndex >= 0) {
          const yearSems = yearGroups[currentAcademicYear];
          const firstSemIndex = timelineData.findIndex(
            (s) => s.year === currentAcademicYear,
          );
          const markerPosition = ((firstSemIndex + 1) / totalSemesters) * 100;
          trackProgress.style.width = markerPosition + "%";
        } else {
          trackProgress.style.width = "100%";
        }

        // Render semester circles
        timelineData.forEach((sem, index) => {
          const item = document.createElement("div");
          item.className = "timeline-item";

          const completedPercent =
            (sem.completedCredits / sem.totalCredits) * 100;
          const currentPercent = (sem.currentCredits / sem.totalCredits) * 100;
          const totalPercent = completedPercent + currentPercent;

          let circleClass = "";
          let circleStyle = "";
          let circleContent = `<span>HK${sem.semester}</span>`;

          if (sem.status === "completed" && sem.progress === 100) {
            circleClass = "completed";
          } else if (sem.status === "active" && sem.completedCredits === 0) {
            circleClass = "active";
          } else if (
            (sem.status === "mixed" || totalPercent > 0) &&
            sem.completedCredits > 0 &&
            sem.currentCredits > 0
          ) {
            circleClass = "partial-mixed";
            circleStyle = `style="--progress-green: ${completedPercent}; --progress-total: ${totalPercent}"`;
          } else if (
            sem.completedCredits > 0 &&
            sem.completedCredits < sem.totalCredits
          ) {
            circleClass = "partial-green";
            circleStyle = `style="--progress-green: ${completedPercent}"`;
          } else if (sem.currentCredits > 0 && sem.completedCredits === 0) {
            circleClass = "partial-yellow";
            circleStyle = `style="--progress-yellow: ${currentPercent}"`;
          } else {
            circleClass = "future";
          }

          let progressBarHTML = "";
          let progressTextClass = "";

          if (completedPercent > 0 && currentPercent > 0) {
            progressBarHTML = `
            <div class="timeline-progress-segment completed" style="width: ${completedPercent}%;"></div>
            <div class="timeline-progress-segment active" style="width: ${currentPercent}%;"></div>
          `;
            progressTextClass = totalPercent > 50 ? "light" : "";
          } else if (completedPercent > 0) {
            progressBarHTML = `<div class="timeline-progress-segment completed" style="width: ${completedPercent}%;"></div>`;
            progressTextClass = completedPercent > 50 ? "light" : "";
          } else if (currentPercent > 0) {
            progressBarHTML = `<div class="timeline-progress-segment active" style="width: ${currentPercent}%;"></div>`;
            progressTextClass = currentPercent > 50 ? "light" : "";
          }

          const displayPercent = Math.round(totalPercent);
          const displayCredits = `${sem.completedCredits + sem.currentCredits}/${sem.totalCredits}`;
          const remainingCredits =
            sem.totalCredits - sem.completedCredits - sem.currentCredits;

          item.innerHTML = `
          <div class="timeline-circle-wrapper">
            <div class="timeline-circle ${circleClass}" ${circleStyle}>
              ${circleContent}
            </div>
          </div>
          <div class="timeline-info">
            <div class="timeline-semester">Học kỳ ${sem.semester}</div>
            <div class="timeline-credits">${displayCredits} tín chỉ</div>
          </div>
          <div class="timeline-progress">
            <div class="timeline-progress-bar">
              ${progressBarHTML}
              <div class="timeline-progress-text ${progressTextClass}">${displayPercent}%</div>
            </div>
          </div>
          <div class="semester-tooltip">
            <div class="tooltip-row">
              <span class="tooltip-label">Học kỳ:</span>
              <span class="tooltip-value">HK${sem.semester}</span>
            </div>
            <div class="tooltip-row">
              <span class="tooltip-label">Đã học:</span>
              <span class="tooltip-value">${sem.completedCredits}/${sem.totalCredits} TC</span>
            </div>
            <div class="tooltip-row">
              <span class="tooltip-label">Đang học:</span>
              <span class="tooltip-value">${sem.currentCredits} TC</span>
            </div>
          </div>
        `;

          container.appendChild(item);
        });

        const startMarker = document.createElement("div");
        startMarker.className = "timeline-year-marker";
        startMarker.style.left = "0%";
        startMarker.innerHTML = `
        <div class="timeline-year-dot current"></div>
        <div class="timeline-year-label">9/2022</div>
      `;
        markersContainer.appendChild(startMarker);

        uniqueYears.forEach((year, yearIndex) => {
          const yearSems = yearGroups[year];
          const firstSemIndex = timelineData.findIndex((s) => s.year === year);
          const totalSemesters = timelineData.length;

          // Position in the middle between sem1 and sem2 of this year
          // Middle = (index0 + index1) / 2 = index0 + 0.5
          // Convert to percentage: (middle / total) * 100
          const middlePosition = firstSemIndex + 1;
          const positionPercent = (middlePosition / totalSemesters) * 100;

          const marker = document.createElement("div");
          marker.className = "timeline-year-marker";
          marker.style.left = positionPercent + "%";

          const dotClass = year <= currentAcademicYear ? "current" : "future";
          const semestersList = yearSems
            .map((s) => `HK${s.semester}`)
            .join(", ");

          marker.innerHTML = `
          <div class="timeline-year-dot ${dotClass}"></div>
          <div class="timeline-year-label">${year}</div>
          <div class="timeline-year-semesters">${semestersList}</div>
        `;
          markersContainer.appendChild(marker);
        });

        const endMarker = document.createElement("div");
        let stylesCustom = "future";
        stylesCustom = currentYearIndex >= 0 ? "future" : "current";
        endMarker.className = "timeline-year-marker";
        endMarker.style.left = "100%";
        endMarker.innerHTML = `
        <div class="timeline-year-dot ${stylesCustom}"></div>
        <div class="timeline-year-label">6/2026</div>
      `;
        markersContainer.appendChild(endMarker);

        // addTooltipListeners();
      }
      // End of DISABLED renderTimeline function

      // Tab switching
      document
        .getElementById("semesterTab")
        .addEventListener("click", function () {
          this.classList.add("active");
          document.getElementById("knowledgeTab").classList.remove("active");
        });

      document
        .getElementById("knowledgeTab")
        .addEventListener("click", function () {
          this.classList.add("active");
          document.getElementById("semesterTab").classList.remove("active");
        });

      // Filter buttons
      document.querySelectorAll(".filter-btn").forEach((btn) => {
        btn.addEventListener("click", function () {
          document
            .querySelectorAll(".filter-btn")
            .forEach((b) => b.classList.remove("active"));
          this.classList.add("active");
        });
      });

      function toggleSection(header) {
        const icon = header.querySelector(".section-icon");
        const content = header.nextElementSibling;

        // Close all other sections
        document.querySelectorAll(".section-header").forEach((h) => {
          if (h !== header) {
            h.classList.remove("expanded");
            h.querySelector(".section-icon").classList.remove("rotated");
            h.nextElementSibling.classList.remove("active");
          }
        });

        // Toggle current section
        header.classList.toggle("expanded");
        icon.classList.toggle("rotated");
        content.classList.toggle("active");
      }

      $(function () {
        var tooltipTriggerList = [].slice.call(
          document.querySelectorAll('[data-bs-toggle="tooltip"]'),
        );
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
          return new bootstrap.Tooltip(tooltipTriggerEl);
        });
      });

      // Search functionality
      document
        .getElementById("searchInput")
        .addEventListener("input", function () {
          const searchTerm = this.value.toLowerCase();
        });
    </script>
  </body>
</html>
